<script>
import {IUXFold, IUXRevealArea, IUXRevealContainer} from 'svelte-iux';

import Notifications from 'svelte-notifications';
import {notifications} from './notifications.js';
  
import SourceUI from './interfaces/SourceUI.svelte';
// import ViewModelUI from './viewmodels/ViewModelUI.svelte';
import ViewModelFoldsUI from './viewmodels/ViewModelFoldsUI.svelte';

import {resultDataStore} from './stores.js';

// Initial visual states
// TODO automatically preserve some application state (in localstorage?)
// TODO provide for reset of defaults (e.g. delete stored state)
let dataSourceUI = false;
$: dataSourceUIButtonText = dataSourceUI ? '<<Less' : 'More>>';
let tray1DataSource = true;

window.debugView = false;

let disableSources = false;
</script>

<style>
h1 {
  color: purple;
}

</style>

<Notifications>
  <h1>Visualisation Lab</h1>
  <p>
    VisLab is an experimental workspace for visual analysis of data
    returned from searches on a wide variety of data sources.
    <br/><a role='button' style='cursor: pointer;' on:click={() => dataSourceUI = !dataSourceUI}>{dataSourceUIButtonText}</a>
  </p>
  <label><input type=checkbox bind:checked={disableSources}/>disable sources</label>
  <IUXRevealArea disabled={false} reveal={dataSourceUI}>
    <h2>Load or Query and Visualise Data</h2>
    <p>
      VisLab can 'Load Data' from different data sources such as files or
      online services using queries input manually, selected from a list,
      or generated by filling out a search form. This includes support
      for semantic data (RDF), standard models in JSON and tabular
      data in CSV format. SPARQL endpoints can be queried using a
      general purpose interface which includes example queries for
      use with popular online sources such as DbPedia, as well as
      forms which simplify querying those and other sources.
    </p>
    <p>
      VisLab handles data returned or loaded in a variety of formats
      and models. Different ways of displaying the data are made
      active according to the data loaded. These include network graphs, charts
      and tables. Which views are active depends on visual models generated by the class
      that implements querying or loading of the chosen data source
    </p>
    <h3>JSON ViewModel</h3>
    <p>
      As part of this development JSON models have been designed to
      represent data alongside corresponding Svelte components for their
      visual presentation. The models are offered as a potential standard 
      for use by builders of data analysis applications, not just in Svelte
      but to help interoperation and data exchange across applications. 
      The models are still evolving, so suggestions or feedback are 
      very welcome. See the <a href='https://github.com/theWebalyst/visualisation-lab/wiki/JSON-ViewModel-Specification'>JSON ViewModel Specification</a>.
    </p>
    <h3>Development</h3>
    <p>
      VisLab runs entirely in the browser, powered by Sveltejs, Vega-Lite and 
      D3js. It uses experimental
      <a href='https://github.com/theWebalyst/visualisation-lab/svelte-iux'>svelte-iux</a>
      components to provide a didactic, incremental user experience (iUX).
    </p>
    <p>
      VisLab is easily extendable open source software. For
      example adding support for a new kind of data source involves creating 
      one simple JavaScript class. The VisLab source code is available on 
      <a href='https://github.com/theWebalyst/visualisation-lab'>github</a>
      and suggestions for features, bug reports and software contributions
      are appreciated.
    </p>
  </IUXRevealArea>

  <IUXFold disabled={disableSources} 
    heading='Load Data'
    headingReveal='' 
    headingElement={'h3'} 
    protrudingHeight={44}
    buttonLabel='open'
    buttonLabelReveal='close' 
    reveal={true} >
    <SourceUI resultDataStore={resultDataStore}/>
  </IUXFold>

  <ViewModelFoldsUI resultDataStore={resultDataStore}/>
  <!-- <ViewModelUI resultDataStore={resultDataStore}/> -->
</Notifications>
